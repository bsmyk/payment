<html>
    <head></head>
    <body>
        <form action="https://kontramedia.github.io/payment/finish.html?v3" class="paymentWidgets">VISA MASTER AMEX</form>
    </body>
    <script>
        var wpwlOptions = {
            locale: "en",
            registrations: {requireCvv: false, hideInitialPaymentForms: false},
            forceCardHolderEqualsBillingName: true,
            billingAddress: {
                country: "",
                state: "",
                city: "",
                postcode: "",
                street1: "",
                street2: ""
            },
            mandatoryBillingFields:{
                country: true,
                state: true,
                city: true,
                postcode: true,
                street1: true,
                street2: false
            },

            onReady: function () {
                var email = '<div class="wpwl-group wpwl-clearfix wpwl-group-customer"><div class="wpwl-label wpwl-label-custom">Email</div>' +
                    '<div class="wpwl-wrapper wpwl-wrapper-custom">' +
                    '<input autocomplete="off" type="text" required name="customer.email" class="wpwl-control" placeholder="Email" maxlength="80" style="">' +
                    '</div></div>';

                $('form.wpwl-form-card').find('.wpwl-button').before(email);

                var createRegistrationHtml = '<div class="customLabel">Store payment details?</div><div class="customInput"><input type="checkbox" name="createRegistration" value="true" /></div>';
                $('form.wpwl-form-card').find('.wpwl-button').before(createRegistrationHtml);
            }
        }
   
        var form = document.getElementsByTagName('form')[0];

        function loadPayments() {
            var head = document.getElementsByTagName('head').item(0);
            var script = document.createElement('script');
            script.setAttribute('type', 'text/javascript');
            script.setAttribute('src', 'https://test.oppwa.com/v1/paymentWidgets.js?checkoutId=BE844C02CAE47FBCCD706EB7CDFE1205.uat01-vm-tx01');
            head.appendChild(script);
        }

        loadPayments();
        function init() {
            if (window.checkoutId) {
                loadPayments();
            }
        }

        function whenRNPostMessageReady(cb) {
            console.log('whenRNPostMessageReady');
            if (window.isReady) cb();
            else setTimeout(function() { whenRNPostMessageReady(cb) }, 1000);
        }

        window.addEventListener('DOMContentLoaded', function() {
            console.log('DOMContentLoaded');
            whenRNPostMessageReady(init);
        }, false);
    </script>
</html>
